### cryptcp.exe signature verification
### 1
–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ CAdES-XL —Å —É—á–µ—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ TSP –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ, –∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω—ã.

## –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ —Å cryptcp.exe

```mermaid
graph TB
    A[–ù–∞—á–∞–ª–æ –ø—Ä–æ–≤–µ—Ä–∫–∏] --> B[–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è]
    B --> C[–ü—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏]
    C --> D{TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω?}
    D -->|–ù–µ—Ç| E[‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞]
    D -->|–î–∞| F[–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏]
    F --> G{–ü–æ–¥–ø–∏—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—É?}
    G -->|–ù–µ—Ç| E
    G -->|–î–∞| H[–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    H --> I{–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏?}
    I -->|–ù–µ—Ç| E
    I -->|–î–∞| J[‚úÖ –ü–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞]
```

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:**
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ö—Ä–∏–ø—Ç–æ–ü–†–û CSP
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è TSA
- –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ TSP

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ö—Ä–∏–ø—Ç–æ–ü–†–û
where cryptcp.exe

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ TSP-—Å–µ—Ä–≤–∏—Å–∞
ping tsp.tensor.ru
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ)

```bash
# –ö–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ TSP
cryptcp -verify -cadestype XL -v "signature.sig" "document.pdf"
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç cryptcp –≤ TSP:**
- –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ TSA –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- –¶–µ–ø–æ—á–∫—É –¥–æ–≤–µ—Ä–∏—è TSA –¥–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –£–¶
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ö—ç—à–∞ –ø–æ–¥–ø–∏—Å–∏

### 3. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏

```python
import subprocess
import re

def verify_signature(signature_file, document_file):
    """
    –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ —Å –∞–Ω–∞–ª–∏–∑–æ–º TSP
    """
    command = [
        "cryptcp.exe",
        "-verify",
        "-cadestype", "XL", 
        "-v",  # –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
        signature_file,
        document_file
    ]
    
    result = subprocess.run(command, capture_output=True, text=True, encoding='cp866')
    
    return analyze_verification_result(result)

def analyze_verification_result(result):
    """
    –ê–Ω–∞–ª–∏–∑ –≤—ã–≤–æ–¥–∞ cryptcp —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ TSP
    """
    output = result.stdout + result.stderr
    
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    checks = {
        'tsp_valid': False,
        'signature_integrity': False,
        'historical_cert_valid': False
    }
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏
    if re.search(r'Timestamp.*valid|–í—Ä–µ–º–µ–Ω–Ω–∞—è.*–º–µ—Ç–∫–∞.*–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞', output, re.IGNORECASE):
        checks['tsp_valid'] = True
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏
    if re.search(r'signature.*valid|–ø–æ–¥–ø–∏—Å—å.*–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞', output, re.IGNORECASE):
        checks['signature_integrity'] = True
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    if re.search(r'certificate.*was.*valid|—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç.*–±—ã–ª.*–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω', output, re.IGNORECASE):
        checks['historical_cert_valid'] = True
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    if checks['tsp_valid'] and checks['signature_integrity']:
        return "‚úÖ –ü–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞"
    else:
        return "‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞"
```

### 4. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∫–æ–¥–æ–≤ –≤–æ–∑–≤—Ä–∞—Ç–∞ cryptcp.exe

```python
def interpret_exit_code(exit_code):
    """
    –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∫–æ–¥–æ–≤ –≤–æ–∑–≤—Ä–∞—Ç–∞ cryptcp.exe
    """
    exit_codes = {
        0: "‚úÖ –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞",
        1: "‚ùå –û–±—â–∞—è –æ—à–∏–±–∫–∞",
        2: "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∏", 
        3: "‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º",
        4: "‚ùå –û—à–∏–±–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è",
        5: "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏"
    }
    return exit_codes.get(exit_code, f"‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–æ–¥ –æ—à–∏–±–∫–∏: {exit_code}")
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
cryptcp -verify -cadestype XL "document.pdf.sig" "document.pdf"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ TSP
```bash
cryptcp -verify -cadestype XL -v -tsp "http://tsp.tensor.ru" "document.pdf.sig" "document.pdf"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
```bash
# –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, cryptcp –Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Å—Ä–æ—á–∫–∏
# –ù–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
cryptcp -verify -cadestype XL -store "My" "document.pdf.sig" "document.pdf"
```

## –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ Python

```python
import subprocess
import os
from datetime import datetime

class SignatureVerifier:
    def __init__(self, cryptcp_path="cryptcp.exe"):
        self.cryptcp_path = cryptcp_path
        
    def verify_signature(self, signature_path, document_path):
        """
        –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ TSP
        """
        print(f"üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏: {os.path.basename(signature_path)}")
        print(f"üìÑ –î–æ–∫—É–º–µ–Ω—Ç: {os.path.basename(document_path)}")
        print(f"üïí –í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏: {datetime.now()}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤
        if not os.path.exists(signature_path):
            return "‚ùå –§–∞–π–ª –ø–æ–¥–ø–∏—Å–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω"
        if not os.path.exists(document_path):
            return "‚ùå –§–∞–π–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω"
        
        # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
        command = [
            self.cryptcp_path,
            "-verify",
            "-cadestype", "XL",
            "-v",
            signature_path,
            document_path
        ]
        
        try:
            result = subprocess.run(
                command,
                capture_output=True,
                text=True,
                encoding='cp866',
                timeout=30
            )
            
            return self.analyze_result(result)
            
        except subprocess.TimeoutExpired:
            return "‚ùå –¢–∞–π–º–∞—É—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏"
        except FileNotFoundError:
            return "‚ùå cryptcp.exe –Ω–µ –Ω–∞–π–¥–µ–Ω"
    
    def analyze_result(self, result):
        """
        –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
        """
        analysis = {
            'success': result.returncode == 0,
            'exit_code': result.returncode,
            'tsp_status': 'unknown',
            'signature_status': 'unknown',
            'certificate_status': 'unknown'
        }
        
        output = result.stdout + result.stderr
        
        # –ê–Ω–∞–ª–∏–∑ TSP
        if 'timestamp verified' in output.lower() or '–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞' in output.lower():
            analysis['tsp_status'] = 'valid'
        elif 'timestamp invalid' in output.lower() or '–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞' in output.lower():
            analysis['tsp_status'] = 'invalid'
        
        # –ê–Ω–∞–ª–∏–∑ –ø–æ–¥–ø–∏—Å–∏
        if 'signature verified' in output.lower() or '–ø–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞' in output.lower():
            analysis['signature_status'] = 'valid'
        elif 'signature invalid' in output.lower() or '–ø–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞' in output.lower():
            analysis['signature_status'] = 'invalid'
        
        # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –≤–µ—Ä–¥–∏–∫—Ç–∞
        return self.generate_verdict(analysis, output)
    
    def generate_verdict(self, analysis, output):
        """
        –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –∑–∞–∫–ª—é—á–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞
        """
        # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
        if analysis['tsp_status'] != 'valid':
            return "‚ùå –ü–û–î–ü–ò–°–¨ –ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê: TSP-–º–µ—Ç–∫–∞ –Ω–µ –ø—Ä–æ—à–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫—É"
        
        if analysis['signature_status'] != 'valid':
            return "‚ùå –ü–û–î–ü–ò–°–¨ –ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê: –Ω–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏"
        
        # –ï—Å–ª–∏ TSP –∏ –ø–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã - –ø–æ–¥–ø–∏—Å—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π
        # –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
        if analysis['success']:
            return "‚úÖ –ü–û–î–ü–ò–°–¨ –î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê"
        else:
            # –î–∞–∂–µ –µ—Å–ª–∏ cryptcp –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É, –Ω–æ TSP –∏ –ø–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã,
            # —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑-–∑–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
            if analysis['tsp_status'] == 'valid' and analysis['signature_status'] == 'valid':
                return "‚úÖ –ü–û–î–ü–ò–°–¨ –î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê (TSP –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –º–æ–≥ –∏—Å—Ç–µ—á—å)"
            else:
                return f"‚ùå –ü–û–î–ü–ò–°–¨ –ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê. –ö–æ–¥: {analysis['exit_code']}"

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if __name__ == "__main__":
    verifier = SignatureVerifier()
    result = verifier.verify_signature("document.pdf.sig", "document.pdf")
    print(result)
```

## –û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –°–ª—É—á–∞–π 1: –ü—Ä–æ—Å—Ä–æ—á–µ–Ω —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
```bash
# cryptcp –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É, –Ω–æ –µ—Å–ª–∏ TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω - –ø–æ–¥–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∏–ª—É
cryptcp -verify ... 
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–¥ 3, –Ω–æ TSP –ø—Ä–æ–≤–µ—Ä–µ–Ω - –ø–æ–¥–ø–∏—Å—å –î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê
```

### –°–ª—É—á–∞–π 2: –ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π TSP
```bash
# –õ—é–±–∞—è –æ—à–∏–±–∫–∞ TSP –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π
cryptcp -verify ...
# TSP –Ω–µ –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É - –ø–æ–¥–ø–∏—Å—å –ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê
```

### –°–ª—É—á–∞–π 3: –ù–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
```bash
# –ò–∑–º–µ–Ω–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç –∏–ª–∏ –ø–æ–¥–ø–∏—Å—å
cryptcp -verify ...
# –ù–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å - –ø–æ–¥–ø–∏—Å—å –ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê
```

## –í—ã–≤–æ–¥—ã:

1. **TSP-–º–µ—Ç–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –ü–†–ò –ü–†–û–í–ï–†–ö–ï** - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ
2. **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞** –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω - –≤–∞–∂–Ω–æ —Ç–æ–ª—å–∫–æ –µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
3. **Cryptcp.exe** –Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ—Å—Ä–æ—á–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –Ω–æ —Ñ–æ–∫—É—Å –Ω–∞ TSP –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å
4. **–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏** –¥–æ–ª–∂–µ–Ω –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å TSP –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏

–î–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏ —É—á–µ—Ç–æ–º –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

### 2
## –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ TSP

```mermaid
flowchart TD
    A[–ù–∞—á–∞–ª–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏] --> B[–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è]
    
    B --> C[–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–∞–π–ª–æ–≤]
    C --> D{–§–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç?}
    D -->|–ù–µ—Ç| E[‚ùå –û—à–∏–±–∫–∞: —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã]
    D -->|–î–∞| F[–ó–∞–ø—É—Å–∫ cryptcp.exe –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏]
    
    F --> G[–ê–Ω–∞–ª–∏–∑ –≤—ã–≤–æ–¥–∞ cryptcp]
    
    subgraph G [–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤]
        H[–ü—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏]
        I[–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏]
        J[–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞]
    end
    
    H --> K{TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω?}
    K -->|–ù–µ—Ç| L[‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞<br>TSP –Ω–µ –ø—Ä–æ—à–µ–ª –ø—Ä–æ–≤–µ—Ä–∫—É]
    
    K -->|–î–∞| I
    I --> M{–ü–æ–¥–ø–∏—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—É?}
    M -->|–ù–µ—Ç| N[‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞<br>–ù–∞—Ä—É—à–µ–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å]
    
    M -->|–î–∞| J
    J --> O{–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω<br>–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è?}
    
    O -->|–ù–µ—Ç| P[‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞<br>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
    O -->|–î–∞| Q[‚úÖ –ü–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞]
    
    style A fill:#e1f5fe
    style L fill:#ffebee
    style N fill:#ffebee
    style P fill:#ffebee
    style Q fill:#e8f5e9
    style H fill:#fff3e0
    style I fill:#fff3e0
    style J fill:#fff3e0
```

## –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

```mermaid
flowchart TD
    A[–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫] --> B[TSP-–º–µ—Ç–∫–∞]
    A --> C[–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏]
    A --> D[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞]
    
    subgraph B [–ü—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏]
        B1[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç TSA –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
        B2[–¶–µ–ø–æ—á–∫–∞ –¥–æ–≤–µ—Ä–∏—è TSA –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞]
        B3[–í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞]
        B4[–•—ç—à –ø–æ–¥–ø–∏—Å–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç]
    end
    
    subgraph C [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏]
        C1[–ü–æ–¥–ø–∏—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—É]
        C2[–§–æ—Ä–º–∞—Ç CAdES-XL –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω]
        C3[–•—ç—à –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–µ –∏–∑–º–µ–Ω–µ–Ω]
    end
    
    subgraph D [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞]
        D1[–í–ª–æ–∂–µ–Ω–Ω—ã–π OCSP-–æ—Ç–≤–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
        D2[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –±—ã–ª –æ—Ç–æ–∑–≤–∞–Ω<br>–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è]
        D3[–¶–µ–ø–æ—á–∫–∞ –±—ã–ª–∞ –ø–æ–ª–Ω–æ–π<br>–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è]
    end
    
    B --> E{‚úÖ TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω?}
    C --> F{‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞?}
    D --> G{‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω?}
    
    E & F & G --> H[‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã]
    
    style B fill:#fff3e0
    style C fill:#fff3e0
    style D fill:#fff3e0
    style H fill:#e8f5e9
```

## –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å cryptcp.exe

```mermaid
sequenceDiagram
    participant –ü as –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
    participant C –∫–∞–∫ cryptcp.exe
    participant CSP –∫–∞–∫ –ö—Ä–∏–ø—Ç–æ–ü–†–û CSP
    participant T –∫–∞–∫ TSA –°–µ—Ä–≤–∏—Å
    participant –• –∫–∞–∫ –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

    –ü->>C: –ó–∞–ø—É—Å–∫: cryptcp -verify -cadestype XL -v signature.sig document.pdf
    C->>CSP: –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ CAdES-XL
    C->>CSP: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ TSP-–º–µ—Ç–∫–∏
    C->>T: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ TSA
    T-->>C: –°—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ TSA
    C->>–•: –ü–æ–∏—Å–∫ –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ TSA
    –•-->>C: –ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã
    C->>CSP: –ü—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏
    CSP-->>C: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ TSP
    C->>CSP: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏
    CSP-->>C: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
    C->>CSP: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
    CSP-->>C: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    C-->>–ü: –ö–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
    
    –ü->>–ü: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ TSP
    –ü->>–ü: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –≤–µ—Ä–¥–∏–∫—Ç–∞
```

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```mermaid
flowchart TD
    A[–ê–Ω–∞–ª–∏–∑ –≤—ã–≤–æ–¥–∞ cryptcp.exe] --> B[–ü–æ–∏—Å–∫ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑]
    
    B --> C[TSP-–º–µ—Ç–∫–∞]
    B --> D[–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏]
    B --> E[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞]
    
    C --> C1[‚Äútimestamp verified‚Äù<br>‚Äú–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞‚Äù]
    C1 --> C2[‚úÖ TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
    
    D --> D1[‚Äúsignature verified‚Äù<br>‚Äú–ø–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞‚Äù]
    D1 --> D2[‚úÖ –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞]
    
    E --> E1[‚Äúcertificate was valid‚Äù<br>‚Äú—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω‚Äù]
    E1 --> E2[‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
    
    C2 & D2 --> F[‚úÖ –ü–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞]
    
    C --> C3[‚Äútimestamp invalid‚Äù<br>‚Äú–≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞‚Äù]
    C3 --> G[‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ TSP]
    
    D --> D3[‚Äúsignature invalid‚Äù<br>‚Äú–ø–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞‚Äù]
    D3 --> H[‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏]
    
    E --> E3[‚Äúcertificate was invalid‚Äù<br>‚Äú—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω‚Äù]
    E3 --> I[‚ùå –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
    
    G --> J[‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞]
    H --> J
    I --> J
    
    style F fill:#e8f5e9
    style J fill:#ffebee
    style C2 fill:#e8f5e9
    style D2 fill:#e8f5e9
    style E2 fill:#e8f5e9
    style G fill:#ffebee
    style H fill:#ffebee
    style I fill:#ffebee
```

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏

```mermaid
flowchart TD
    A[–ö—Ä–∏—Ç–µ—Ä–∏–∏ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏] --> B[–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ]
    A --> C[–í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ]
    
    B --> B1[TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ]
    B --> B2[–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞]
    B --> B3[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏]
    
    C --> C1[–ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã]
    C --> C2[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω —Å–µ–π—á–∞—Å]
    C --> C3[–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ OCSP-–æ—Ç–≤–µ—Ç—ã]
    
    B1 & B2 & B3 --> D[‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è –ø–æ–¥–ø–∏—Å—å]
    
    C1 -.->|–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é –ø–æ–¥–ø–∏—Å—å| D
    C2 -.->|–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é –ø–æ–¥–ø–∏—Å—å| D
    C3 -.->|–ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é –ø–æ–¥–ø–∏—Å—å| D
    
    style B fill:#fff3e0
    style C fill:#f5f5f5
    style D fill:#e8f5e9
```

–≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ TSP-–º–µ—Ç–∫–∏ —è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º —ç—Ç–∞–ø–æ–º, –æ—Ç –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞–≤–∏—Å–∏—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –≤—Å–µ–π —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

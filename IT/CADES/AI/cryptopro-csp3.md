## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏

–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —É—Ç–∏–ª–∏—Ç—É cryptcp –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ CAdES-XL –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–æ—Ä–Ω–µ–≤—ã–µ –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶, –∞ —Ç–∞–∫–∂–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã OCSP-—Å–µ—Ä–≤–µ—Ä—ã –∏–ª–∏ CRL-—Å–ø–∏—Å–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞.

–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏:
- –ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π –∑–∞–ø—É—Å–∫–∞–µ—Ç cryptcp —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º -verify –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏.
- cryptcp –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ –ø–æ–¥–ø–∏—Å–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –∏ —Ü–µ–ø–æ—á–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ü–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –¥–ª—è —á–µ–≥–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Windows (–∏–ª–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ö—Ä–∏–ø—Ç–æ–ü–†–û).
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –∏ –≤—Å–µ—Ö –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (—Å –ø–æ–º–æ—â—å—é OCSP –∏–ª–∏ CRL). –î–ª—è —ç—Ç–æ–≥–æ cryptcp –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ –ø–æ–¥–ø–∏—Å–∏ OCSP-–æ—Ç–≤–µ—Ç—ã –∏–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (OCSP-—Å–µ—Ä–≤–µ—Ä—ã, CRL-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏).

–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏:
```
cryptcp -verify -cadestype XL –ø–æ–¥–ø–∏—Å—å.sig –¥–æ–∫—É–º–µ–Ω—Ç.pdf
```
–ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –æ—Ç–¥–µ–ª–µ–Ω–Ω–∞—è (detached), —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å —Ñ–∞–π–ª –ø–æ–¥–ø–∏—Å–∏ –∏ —Ñ–∞–π–ª –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ï—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–Ω–∞—è (attached), —Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–∞–π–ª –ø–æ–¥–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏ –¥–æ–∫—É–º–µ–Ω—Ç.

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –ö—Ä–∏–ø—Ç–æ–ü–†–û CSP (—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∫–æ—Ä–Ω–µ–≤—ã–º–∏ –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ –£–¶ –ö–æ–Ω—Ç—É—Ä)
- –£—Ç–∏–ª–∏—Ç–∞ cryptcp.exe (–≤—Ö–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–∞–≤ –ö—Ä–∏–ø—Ç–æ–ü–†–û)
- –î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ OCSP –∏–ª–∏ CRL (–∏–ª–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ CRL)

–ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–ø–∏—Å–∏ cryptcp –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:
- –ü—Ä–æ–≤–µ—Ä–∏—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç, —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è (—Å —É—á–µ—Ç–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏).
- –ü—Ä–æ–≤–µ—Ä–∏—Ç —Ü–µ–ø–æ—á–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –ø—Ä–æ–≤–µ—Ä–∫—É –æ—Ç–∑—ã–≤–∞ –∫–æ—Ä–Ω–µ–≤—ã—Ö –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç, —á—Ç–æ –ø–æ–¥–ø–∏—Å—å –±—ã–ª–∞ —Å–¥–µ–ª–∞–Ω–∞ –≤ –ø–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞.

  –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º cryptcp —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ -verify –∏ -cadestype XL, –ø–µ—Ä–µ–¥–∞–≤–∞—è –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –ø–æ–¥–ø–∏—Å–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∫–æ–¥—É –≤–æ–∑–≤—Ä–∞—Ç–∞.

–í–∞–∂–Ω–æ: –î–ª—è —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –ö–æ–Ω—Ç—É—Ä –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã. –¢–∞–∫–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ OCSP-—Å–µ—Ä–≤–µ—Ä—É –£–¶ –ö–æ–Ω—Ç—É—Ä –∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ CRL-—Å–ø–∏—Å–∫–∏.

–ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å CRL-—Å–ø–∏—Å–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ö—Ä–∏–ø—Ç–æ–ü–†–û –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö CRL.

## –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```mermaid
graph TB
    subgraph "–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏"
        A[–ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏] --> B[cryptcp.exe]
        A --> C[–ö—Ä–∏–ø—Ç–æ–ü–†–û CSP]
        
        C --> D[–°–∏—Å—Ç–µ–º–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Windows]
        D --> E[–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ –£–¶]
        D --> F[–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –£–¶]
        D --> G[–°–ø–∏—Å–∫–∏ –æ—Ç–∑—ã–≤–∞ CRL]
        
        A --> H[–í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã]
        H --> I[–£–¶ –ö–æ–Ω—Ç—É—Ä OCSP]
        H --> J[–°–µ—Ä–≤–µ—Ä—ã CRL]
        H --> K[–¢–µ–Ω–∑–æ—Ä TSP]
    end
    
    L[–ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç<br>–¥–æ–∫—É–º–µ–Ω—Ç + –ø–æ–¥–ø–∏—Å—å CAdES-XL] --> A
```

## –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏

```mermaid
sequenceDiagram
    participant –ü–ü as –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏
    participant CryptCP as cryptcp.exe
    participant CSP as –ö—Ä–∏–ø—Ç–æ–ü–†–û CSP
    participant –•–† as –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
    participant –û–° as –£–¶ –ö–æ–Ω—Ç—É—Ä OCSP
    participant CRL as –°–µ—Ä–≤–µ—Ä—ã CRL
    participant –¢–° as –¢–µ–Ω–∑–æ—Ä TSP

    Note over –ü–ü,CryptCP: 1. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏
    –ü–ü->>CryptCP: cryptcp -verify -cadestype XL signature.sig document.pdf
    
    Note over CryptCP,CryptCP: 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CAdES-XL
    CryptCP->>CryptCP: –ü–∞—Ä—Å–∏–Ω–≥ CAdES-XL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
    CryptCP->>CryptCP: - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
    CryptCP->>CryptCP: - –¶–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
    CryptCP->>CryptCP: - OCSP-–æ—Ç–≤–µ—Ç
    CryptCP->>CryptCP: - TSP-–º–µ—Ç–∫–∞
    CryptCP->>CryptCP: - –ü–æ–¥–ø–∏—Å—å –∏ —Ö—ç—à –¥–æ–∫—É–º–µ–Ω—Ç–∞
    
    Note over CryptCP,CSP: 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
    CryptCP->>CSP: –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏
    CSP-->>CryptCP: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏
    
    Note over CryptCP,–•–†: 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è
    CryptCP->>–•–†: –ü–æ–∏—Å–∫ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –£–¶ –ö–æ–Ω—Ç—É—Ä
    –•–†-->>CryptCP: –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
    CryptCP->>CSP: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
    CSP-->>CryptCP: –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–æ—á–∫–∏
    
    Note over CryptCP,–û–°: 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    CryptCP->>–û–°: –ó–∞–ø—Ä–æ—Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ OCSP-—Å—Ç–∞—Ç—É—Å–∞
    –û–°-->>CryptCP: –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    CryptCP->>CryptCP: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º OCSP-–æ—Ç–≤–µ—Ç–æ–º
    
    Note over CryptCP,CRL: 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ CRL
    CryptCP->>CRL: –ó–∞–ø—Ä–æ—Å CRL-—Å–ø–∏—Å–∫–æ–≤ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    CRL-->>CryptCP: –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –æ—Ç–∑—ã–≤–∞
    
    Note over CryptCP,–¢–°: 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏
    CryptCP->>–¢–°: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è TSP-–º–µ—Ç–∫–∏
    –¢–°-->>CryptCP: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏
    
    Note over CryptCP,CryptCP: 8. –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
    CryptCP->>CryptCP: –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∫–∏
    CryptCP-->>–ü–ü: –ö–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
```

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
```mermaid
graph LR
    A[–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏] --> B[–ö—Ä–∏–ø—Ç–æ–ü–†–û CSP]
    A --> C[cryptcp.exe]
    A --> D[–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã]
    A --> E[–ü—Ä–æ–≥—Ä–∞–º–º–∞-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä]
    
    D --> D1[–£–¶ –ö–æ–Ω—Ç—É—Ä –∫–æ—Ä–Ω–µ–≤–æ–π]
    D --> D2[–î—Ä—É–≥–∏–µ –∞–∫–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–Ω—ã–µ –£–¶]
```

### 2. **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:**

**–î–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ:**
- **–ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –ö–æ–Ω—Ç—É—Ä** –≤ `Trusted Root Certification Authorities`
- **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –ö–æ–Ω—Ç—É—Ä** –≤ `Intermediate Certification Authorities`

**–ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ –ø–æ–¥–ø–∏—Å–∏ (–Ω–µ —Ç—Ä–µ–±—É—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏):**
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞
- –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Ü–µ–ø–æ—á–∫–∏
- OCSP-–æ—Ç–≤–µ—Ç
- TSP-–º–µ—Ç–∫–∞

### 3. **–ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:**

```bash
# –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
cryptcp -verify signature.sig document.pdf

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–∞ CAdES
cryptcp -verify -cadestype XL signature.sig document.pdf

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
cryptcp -verify -v -cadestype XL signature.sig document.pdf

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ (–æ—Ñ–ª–∞–π–Ω)
cryptcp -verify -offline -cadestype XL signature.sig document.pdf
```

## –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
```python
def verify_signature(signature_file, document_file):
    """
    –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ cryptcp.exe
    """
    # –ó–∞–ø—É—Å–∫ cryptcp –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
    command = [
        "cryptcp.exe",
        "-verify",
        "-cadestype", "XL",
        "-v",  # –î–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥
        signature_file,
        document_file
    ]
    
    result = subprocess.run(command, capture_output=True, text=True)
    return parse_verification_result(result)
```

### –≠—Ç–∞–ø 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ CAdES-XL**
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ö—ç—à–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞**
- **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏**

### –≠—Ç–∞–ø 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è
```python
def verify_certificate_chain(chain_certificates, trusted_roots):
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
    """
    steps = [
        "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞",
        "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ –£–¶",
        "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–∏—Ç–∏–∫ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏",
        "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª—é—á–∞ (–ø–æ–¥–ø–∏—Å—å)"
    ]
    
    for step in steps:
        if not perform_verification_step(step):
            return False
    return True
```

### –≠—Ç–∞–ø 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞

**–ú–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞:**
```mermaid
graph TB
    A[–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞] --> B[OCSP Online]
    A --> C[CRL Lists]
    A --> D[–í–ª–æ–∂–µ–Ω–Ω—ã–π OCSP]
    
    B --> B1[–ó–∞–ø—Ä–æ—Å –∫ –£–¶ –ö–æ–Ω—Ç—É—Ä OCSP]
    C --> C1[–°–∫–∞—á–∏–≤–∞–Ω–∏–µ CRL]
    C --> C2[–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –ª–æ–∫–∞–ª—å–Ω—ã–º CRL]
    D --> D1[–ê–Ω–∞–ª–∏–∑ OCSP –∏–∑ –ø–æ–¥–ø–∏—Å–∏]
```

### –≠—Ç–∞–ø 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–∏
- **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ TSA**
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–∏**
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–∏—Ç–∏–∫ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫**

## –ö–æ–¥ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### C# –ø—Ä–∏–º–µ—Ä:
```csharp
public class SignatureVerifier
{
    public VerificationResult VerifySignature(string signaturePath, string documentPath)
    {
        ProcessStartInfo startInfo = new ProcessStartInfo
        {
            FileName = "cryptcp.exe",
            Arguments = $"-verify -cadestype XL -v \"{signaturePath}\" \"{documentPath}\"",
            UseShellExecute = false,
            RedirectStandardOutput = true,
            RedirectStandardError = true,
            CreateNoWindow = true
        };

        using (Process process = Process.Start(startInfo))
        {
            process.WaitForExit();
            
            string output = process.StandardOutput.ReadToEnd();
            string error = process.StandardError.ReadToEnd();
            
            return new VerificationResult
            {
                Success = process.ExitCode == 0,
                ExitCode = process.ExitCode,
                Output = output,
                Error = error,
                Details = ParseOutput(output)
            };
        }
    }
    
    private VerificationDetails ParseOutput(string output)
    {
        // –ê–Ω–∞–ª–∏–∑ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ cryptcp
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–∏
        return new VerificationDetails();
    }
}

public class VerificationResult
{
    public bool Success { get; set; }
    public int ExitCode { get; set; }
    public string Output { get; set; }
    public string Error { get; set; }
    public VerificationDetails Details { get; set; }
}
```

## –û—Å–æ–±—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. **–û—Ñ–ª–∞–π–Ω –ø—Ä–æ–≤–µ—Ä–∫–∞ (–±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞):**
```bash
cryptcp -verify -offline -cadestype XL signature.sig document.pdf
```
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ OCSP-–æ—Ç–≤–µ—Ç—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –ª–æ–∫–∞–ª—å–Ω—ã–º CRL-—Å–ø–∏—Å–∫–∞–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è TSP-–º–µ—Ç–æ–∫ –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### 2. **–°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
cryptcp -verify -strict -cadestype XL signature.sig document.pdf
```
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ —Å–≤–µ–∂–∏—Ö CRL-—Å–ø–∏—Å–∫–æ–≤
- –°—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫

### 3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏:**
```bash
cryptcp -verify -store location -cadestype XL signature.sig document.pdf
```

## –ö–æ–¥—ã –≤–æ–∑–≤—Ä–∞—Ç–∞ cryptcp.exe

- **0** - –ø–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞
- **1** - –æ–±—â–∞—è –æ—à–∏–±–∫–∞
- **2** - –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –ø–æ–¥–ø–∏—Å–∏
- **3** - —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç–æ–∑–≤–∞–Ω –∏–ª–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω
- **4** - —Ü–µ–ø–æ—á–∫–∞ –¥–æ–≤–µ—Ä–∏—è –Ω–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞
- **5** - –æ—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

## –í—ã–≤–æ–¥:

–î–ª—è —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
1. **–ö—Ä–∏–ø—Ç–æ–ü–†–û CSP** –∏ **cryptcp.exe**
2. **–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** –£–¶ –ö–æ–Ω—Ç—É—Ä
3. **–î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ (–∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ CRL)
4. **–ü—Ä–æ–≥—Ä–∞–º–º–∞-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ç–æ—Ä**, –∑–∞–ø—É—Å–∫–∞—é—â–∞—è cryptcp

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ (—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞, —Ü–µ–ø–æ—á–∫–∞, OCSP-–æ—Ç–≤–µ—Ç, TSP-–º–µ—Ç–∫–∞) —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤ —Å–∞–º–æ–π CAdES-XL –ø–æ–¥–ø–∏—Å–∏ –∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## 2 –£—Ç–æ—á–Ω–µ–Ω–∏–µ (–æ—â–∏–±–æ—á–Ω–æ–µ)
–í—ã –∑–∞–¥–∞–ª–∏ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –∏ —Ç–æ–Ω–∫–∏–π –≤–æ–ø—Ä–æ—Å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏. –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–æ.

## –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏

```mermaid
graph TB
    A[–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –≠–ü] --> B[–ú–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è]
    A --> C[–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è]
    A --> D[–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞–∑–∞]
    
    B --> B1[–§–∏–∫—Å–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π TSP]
    C --> C1[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω]
    C --> C2[–¶–µ–ø–æ—á–∫–∞ –¥–æ–≤–µ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞]
    D --> D1[–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –ª–∏—á–Ω–æ—Å—Ç–∏]
    D --> D2[–ù–µ–æ—Ç—Ä–µ–∫–∞–µ–º–æ—Å—Ç—å]
```

## –ö–ª—é—á–µ–≤–æ–π –ø—Ä–∏–Ω—Ü–∏–ø: **"–ó–∞–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏"**

**CAdES-XL —Å–æ–∑–¥–∞–µ—Ç "–≤—Ä–µ–º–µ–Ω–Ω—É—é –∫–∞–ø—Å—É–ª—É"**, –∫–æ—Ç–æ—Ä–∞—è —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è:

```mermaid
sequenceDiagram
    participant –î as –î–æ–∫—É–º–µ–Ω—Ç
    participant –ü as –ü–æ–¥–ø–∏—Å—å
    participant –û as OCSP-–æ—Ç–≤–µ—Ç
    participant –¢ as TSP-–º–µ—Ç–∫–∞
    participant –í as –í—Ä–µ–º—è

    –ü->>–û: –°—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
    –ü->>–¢: –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
    –¢->>–í: –§–∏–∫—Å–∞—Ü–∏—è –º–æ–º–µ–Ω—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏
    –û->>–í: –§–∏–∫—Å–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
```

## –ß—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–æ –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏:

### 1. **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞**
- ‚úÖ –î–æ–ª–∂–µ–Ω –±—ã—Ç—å **–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –ù–ê –ú–û–ú–ï–ù–¢ –ü–û–î–ü–ò–°–ê–ù–ò–Ø**
- ‚ùå –ù–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–æ—Ç–æ–∑–≤–∞–Ω–Ω—ã–º –ù–ê –ú–û–ú–ï–ù–¢ –ü–û–î–ü–ò–°–ê–ù–ò–Ø**
- ‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–∫–∞ –ü–û–°–õ–ï –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è **–Ω–µ –≤–ª–∏—è–µ—Ç** –Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é —Å–∏–ª—É

### 2. **OCSP-–æ—Ç–≤–µ—Ç**
- ‚úÖ –§–∏–∫—Å–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ **–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è**
- ‚ùå –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–µ
- ‚úÖ –Ø–≤–ª—è–µ—Ç—Å—è **–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ–º** –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è

### 3. **–ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶**
- ‚úÖ –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ **–Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏**
- ‚ùå –ú–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω—ã - —ç—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é –ø–æ–¥–ø–∏—Å—å
- ‚úÖ –í–∞–∂–Ω–æ, —á—Ç–æ –æ–Ω–∏ –±—ã–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã **–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è**

### 4. **TSP-–º–µ—Ç–∫–∞ (—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è)**
- ‚úÖ **–î–û–õ–ñ–ù–ê –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏**
- ‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç TSA –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º
- ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç "–Ω–µ–æ—Ç—Ä–µ–∫–∞–µ–º–æ—Å—Ç—å" (non-repudiation)

## –£—Ç–æ—á–Ω–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —é—Ä–∏–¥–∏—á–µ—Å–∫—É—é –∑–Ω–∞—á–∏–º–æ—Å—Ç—å

```mermaid
sequenceDiagram
    participant –ü as –ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π
    participant CryptCP as cryptcp.exe
    participant TSP as TSA —Å–µ—Ä–≤–∏—Å

    Note over –ü,CryptCP: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    –ü->>CryptCP: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏
    CryptCP-->>–ü: ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç –Ω–µ –∏–∑–º–µ–Ω–µ–Ω
    
    –ü->>TSP: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ TSP-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
    TSP-->>–ü: ‚úÖ TSP –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
    
    Note over –ü,CryptCP: –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è)
    –ü->>CryptCP: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ OCSP-–æ—Ç–≤–µ—Ç–∞
    CryptCP-->>–ü: ‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏
    
    –ü->>CryptCP: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
    CryptCP-->>–ü: ‚úÖ –¶–µ–ø–æ—á–∫–∞ –±—ã–ª–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏
    
    –ü-->>–ü: üèõÔ∏è –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å cryptcp.exe

### –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—É—á–∏—Ç—ã–≤–∞–µ—Ç TSP)
cryptcp -verify -cadestype XL signature.sig document.pdf

# –° –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
cryptcp -verify -cadestype XL -tsp "http://tsp.tensor.ru" signature.sig document.pdf
```

### –ß—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç cryptcp:
```python
def legal_verification_priority(signature):
    # –í–´–°–û–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π —Å–∏–ª—ã)
    if not verify_tsp_current(signature.tsp):  # TSP –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –°–ï–ô–ß–ê–°
        return "‚ùå TSP –Ω–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω - –ø–æ–¥–ø–∏—Å—å –Ω–µ –∏–º–µ–µ—Ç —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π —Å–∏–ª—ã"
    
    if not verify_signature_integrity(signature):
        return "‚ùå –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∞ - –ø–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞"
    
    # –°–†–ï–î–ù–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å)
    if not verify_ocsp_at_signing_time(signature.ocsp):
        return "‚ö†Ô∏è –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏"
    
    # –ù–ò–ó–ö–ò–ô –ü–†–ò–û–†–ò–¢–ï–¢ (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ)
    if not verify_certificate_chain_at_signing(signature.chain):
        print("‚ÑπÔ∏è –¶–µ–ø–æ—á–∫–∞ –±—ã–ª–∞ –Ω–µ–ø–æ–ª–Ω–æ–π –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏")
    
    return "‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏ –∑–Ω–∞—á–∏–º–∞—è –ø–æ–¥–ø–∏—Å—å"
```

## –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã (—Å–æ–≥–ª–∞—Å–Ω–æ 63-–§–ó)

### –°—Ç–∞—Ç—å—è 11. –ü—Ä–∏–∑–Ω–∞–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏
```mermaid
graph LR
    A[–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Å—å] --> B{–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è?}
    B -->|–î–∞| C[–ü—Ä–∏–∑–Ω–∞–µ—Ç—Å—è —Ä–∞–≤–Ω–æ–∑–Ω–∞—á–Ω–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Ä—É—á–Ω–æ–π]
    B -->|–ù–µ—Ç| D[–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω]
    
    C --> E[–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏]
    E --> E1[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç –∞–∫–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–Ω–æ–≥–æ –£–¶]
    E --> E2[–°—Ä–µ–¥—Å—Ç–≤–∞ –≠–ü —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º]
    E --> E3[–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –≤ –º–æ–º–µ–Ω—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞]
```

## –í—ã–≤–æ–¥—ã:

### –í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã –≤ –≥–ª–∞–≤–Ω–æ–º:
- **TSP-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º **–ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ**
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞** –¥–æ–ª–∂–µ–Ω –±—ã–ª –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º **–ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏**
- **OCSP-–æ—Ç–≤–µ—Ç** —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç
- **–ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏, –Ω–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω—ã

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏:
1. **‚úÖ TSP-–º–µ—Ç–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏**
2. **‚úÖ –ü–æ–¥–ø–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—É**
3. **‚úÖ –ù–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω** (–ø–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–º—É OCSP)

### –í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏
- –°–≤–µ–∂–∏–µ OCSP-–æ—Ç–≤–µ—Ç—ã –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ

**–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–ª—è —é—Ä–∏–¥–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ CAdES-XL –ø–æ–¥–ø–∏—Å–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ TSA –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.**

–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ —ç—Ç–æ—Ç –≥–ª—É–±–æ–∫–∏–π –≤–æ–ø—Ä–æ—Å! –û–Ω –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç —Å–∞–º—É—é —Å—É—Ç—å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞.

### 3 –£—Ç–æ—á–Ω–µ–Ω–∏–µ (–≤–µ—Ä–Ω–æ–µ)

–ü–æ—á–µ–º—É "–ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶" –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏? –í–µ–¥—å –≤ OCSP –æ—Ç–≤–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞, —á—Ç–æ –æ–Ω–∏ –±—ã–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è. 
CADES-XL –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –£–¶ –º–æ–≥—É—Ç –±—ã—Ç—å —É–∂–µ –∑–∞–∫—Ä—ã—Ç—ã.

–ú—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º —Å—Ü–µ–Ω–∞—Ä–∏–π, –∫–æ–≥–¥–∞ –ø–æ–¥–ø–∏—Å—å CAdES-XL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è, –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–∏–µ —Ü–µ–Ω—Ç—Ä—ã (–£–¶) –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç—ã.
–í CAdES-XL –≤–∫–ª—é—á–µ–Ω—ã –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è, –≤–∫–ª—é—á–∞—è —Ü–µ–ø–æ—á–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ OCSP-–æ—Ç–≤–µ—Ç—ã, —Ñ–∏–∫—Å–∏—Ä—É—é—â–∏–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.

–û–¥–Ω–∞–∫–æ, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –±—ã–ª–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏. –≠—Ç–æ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–π—Å—Ç–≤—É—é—â–∏–º–∏ (–Ω–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º–∏) –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–π —Å—Ç–æ—Ä–æ–Ω—ã.

–ù–æ —á—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –£–¶ –∑–∞–∫—Ä—ã—Ç –∏ –µ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±–æ–ª—å—à–µ –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º? –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –Ω–µ –¥–æ–≤–µ—Ä—è—Ç—å —Ü–µ–ø–æ—á–∫–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤.

–†–µ—à–µ–Ω–∏–µ —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ —Å—á–∏—Ç–∞—Ç—å—Å—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥–ø–∏—Å–µ–π, –¥–∞–∂–µ –µ—Å–ª–∏ –£–¶ —É–∂–µ –∑–∞–∫—Ä—ã—Ç.

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:
- –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–¥–ø–∏—Å–∏, —Å–æ–∑–¥–∞–Ω–Ω–æ–π –≤ –ø—Ä–æ—à–ª–æ–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ—Ç –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–π —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∞—Ä—Ö–∏–≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–µ—Ä–∏–æ–¥–æ–≤ –∏—Ö –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–û–¥–Ω–∞–∫–æ, –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –ø–æ–º–æ—â—å—é cryptcp.exe –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –ö—Ä–∏–ø—Ç–æ–ü–†–û, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –ü–æ—ç—Ç–æ–º—É, –µ—Å–ª–∏ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –£–¶ –±—ã–ª —É–¥–∞–ª–µ–Ω –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ç–æ–º—É —á—Ç–æ –£–¶ –∑–∞–∫—Ä—ã—Ç), —Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–æ–π—Ç–∏.

–ö–∞–∫ –±—ã—Ç—å?

–í CAdES-XL –≤–∫–ª—é—á–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –£–¶. –ù–æ –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–µ –ü–û (cryptcp) –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –ï—Å–ª–∏ –µ–≥–æ —Ç–∞–º –Ω–µ—Ç, —Ç–æ —Ü–µ–ø–æ—á–∫–∞ –Ω–µ –±—É–¥–µ—Ç –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–π.

–í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

- –î–æ–±–∞–≤–∏—Ç—å –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –£–¶ –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –£–¶ —É–∂–µ –∑–∞–∫—Ä—ã—Ç. –≠—Ç–æ –¥–æ–ø—É—Å—Ç–∏–º–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –æ–Ω –±—ã–ª –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º—ã –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –∫–æ—Ä–Ω–µ–≤—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.

–ù–æ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏. –ï—Å–ª–∏ –£–¶ –∑–∞–∫—Ä—ã—Ç, —Ç–æ –µ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ä—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π.

–ü–æ—ç—Ç–æ–º—É –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ CAdES-XL —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
- –í–∫–ª—é—á–∞—Ç—å –≤ –ø–æ–¥–ø–∏—Å—å –ø–æ–ª–Ω—É—é —Ü–µ–ø–æ—á–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –£–¶.
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞—Ö –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ.

–û–¥–Ω–∞–∫–æ, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (cryptcp) –Ω–µ –∏–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è. –ü–æ—ç—Ç–æ–º—É –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —á–∞—Å—Ç–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –∫–æ—Ä–Ω–µ–≤—ã–º–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏.

–í—ã–≤–æ–¥: –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ CAdES-XL, —Å–æ–∑–¥–∞–Ω–Ω–æ–π –≤ –ø—Ä–æ—à–ª–æ–º, –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –£–¶ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏. –ï—Å–ª–∏ –£–¶ –∑–∞–∫—Ä—ã—Ç, —Ç–æ –µ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ.

–ù–æ –ø–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã–π –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç? –ü–æ—Ç–æ–º—É —á—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–æ—á–∫–∏ –≤ –ö—Ä–∏–ø—Ç–æ–ü–†–û (–∏ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –¥—Ä—É–≥–∏—Ö —Å–∏—Å—Ç–µ–º) —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –í–ª–æ–∂–µ–Ω–Ω—ã–π –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –æ–Ω –≤–ª–æ–∂–µ–Ω –≤ –ø–æ–¥–ø–∏—Å—å. –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö —Ü–µ–ø–æ—á–µ–∫.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ CAdES-XL, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–µ–Ω–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:
- –ò–º–µ—Ç—å –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ OCSP-–æ—Ç–≤–µ—Ç—ã –∏ TSP-–º–µ—Ç–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã –∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.

–ï—Å–ª–∏ –£–¶ –∑–∞–∫—Ä—ã—Ç –∏ –µ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è –Ω–µ –ø—Ä–æ–π–¥–µ—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–¥–ø–∏—Å—å –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –ø–µ—Ä–∏–æ–¥, –∫–æ–≥–¥–∞ –£–¶ –±—ã–ª –¥–µ–π—Å—Ç–≤—É—é—â–∏–º.

–ü–æ—ç—Ç–æ–º—É —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —á—Ç–æ "–∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏", –≤–µ—Ä–Ω–æ –≤ —Ç–æ–º —Å–º—ã—Å–ª–µ, —á—Ç–æ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã. –ù–æ –∏—Ö –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è) –Ω–µ –≤–∞–∂–Ω–∞, –≤–∞–∂–Ω–æ –¥–æ–≤–µ—Ä–∏–µ –∫ –Ω–∏–º.

–í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ cryptcp.exe, –µ—Å–ª–∏ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ø–æ—á–∫–∏ –¥–æ–≤–µ—Ä–∏—è –Ω–µ —É–¥–∞—Å—Ç—Å—è, –∏ cryptcp –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É.

–†–µ–∑—é–º–µ:
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏ CAdES-XL –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏, –±—ã–ª–∏ –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–æ–≤–µ—Ä—è—é—â–µ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏.
- –°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –Ω–µ –≤–∞–∂–µ–Ω, –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏.
- –ï—Å–ª–∏ –£–¶ –∑–∞–∫—Ä—ã—Ç, —Ç–æ –µ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –≤—Ä—É—á–Ω—É—é, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å–∏, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –≤ –ø–µ—Ä–∏–æ–¥ –µ–≥–æ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

–≠—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–ø—Ä–æ—â–∞–µ—Ç –∑–∞–¥–∞—á—É, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (–æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ä–æ—á–µ–Ω—ã), –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∏—Ö –Ω–∞–ª–∏—á–∏—è –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

–í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã –∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç–µ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –∞—Å–ø–µ–∫—Ç –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π! –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –¥–µ—Ç–∞–ª—å–Ω–æ.

## –ü—Ä–æ–±–ª–µ–º–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞—Ä—Ö–∏–≤–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

```mermaid
graph TB
    A[–ü—Ä–æ–±–ª–µ–º–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏] --> B[–ó–∞–∫—Ä—ã—Ç—ã–µ –£–¶]
    A --> C[–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã]
    A --> D[–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–ø–æ—á–µ–∫ –¥–æ–≤–µ—Ä–∏—è]
    
    B --> B1[–£–¶ –ö–æ–Ω—Ç—É—Ä –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å—Å—è]
    C --> C1[–ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –∏—Å—Ç–µ–∫–∞—é—Ç]
    D --> D1[–ù–æ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏]
    
    E[–†–µ—à–µ–Ω–∏–µ CAdES-XL] --> F[–ê—Ä—Ö–∏–≤–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏]
    E --> G[–í–ª–æ–∂–µ–Ω–Ω—ã–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞]
    E --> H[–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è]
```

## –ü–æ—á–µ–º—É —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å:

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```bash
cryptcp -verify signature.sig document.pdf
# –ú–æ–∂–µ—Ç FAIL, –µ—Å–ª–∏ –∫–æ—Ä–Ω–µ–≤–æ–π –£–¶ –∑–∞–∫—Ä—ã—Ç
```

### –ü—Ä–æ–±–ª–µ–º–∞ –≤ –¥–µ—Ç–∞–ª—è—Ö:
```mermaid
sequenceDiagram
    participant –ü as –ü—Ä–æ–≤–µ—Ä—è—é—â–∏–π (2024)
    participant CryptCP as cryptcp.exe
    participant –•–† as –•—Ä–∞–Ω–∏–ª–∏—â–µ 2024
    participant –£–¶ as –£–¶ –ö–æ–Ω—Ç—É—Ä (–∑–∞–∫—Ä—ã—Ç –≤ 2023)

    –ü->>CryptCP: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ 2020 –≥–æ–¥–∞
    CryptCP->>–•–†: –ü–æ–∏—Å–∫ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –£–¶ –ö–æ–Ω—Ç—É—Ä
    –•–†-->>CryptCP: ‚ùå –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω (–£–¶ –∑–∞–∫—Ä—ã—Ç)
    CryptCP-->>–ü: –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ø–æ—á–∫–∏
```

## –†–µ—à–µ–Ω–∏–µ: –ê—Ä—Ö–∏–≤–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ LTV (Long-Term Validation)

### CAdES-XL –∫–∞–∫ "–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–∞–ø—Å—É–ª–∞":
```mermaid
graph LR
    A[CAdES-XL –ü–æ–¥–ø–∏—Å—å] --> B[–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞]
    A --> C[–ü–æ–ª–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤]
    A --> D[OCSP-–æ—Ç–≤–µ—Ç –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è]
    A --> E[TSP-–º–µ—Ç–∫–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è]
    A --> F[–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏]
    
    G[–ê—Ä—Ö–∏–≤–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è] --> H[–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö]
    G --> I[–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –£–¶]
    G --> J[–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ TSP]
```

## –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ:

### 1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏**
–î–ª—è –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –ø–æ–¥–ø–∏—Å–µ–π –º—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ "–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ —Å–µ–π—á–∞—Å", –∞ **"–±—ã–ª–æ –ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç–æ–≥–¥–∞"**.

### 2. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:**
```python
def archival_verification(cades_xl_signature):
    # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –ü–†–û–í–ï–†–ö–ò:
    # 1. –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
    if not verify_signature_integrity(cades_xl_signature):
        return "‚ùå –ü–æ–¥–ø–∏—Å—å –Ω–∞—Ä—É—à–µ–Ω–∞"
    
    # 2. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å TSP –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
    if not verify_tsp_at_signing_time(cades_xl_signature.tsp):
        return "‚ùå TSP –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è"
    
    # 3. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è (–ø–æ OCSP)
    if not verify_ocsp_at_signing_time(cades_xl_signature.ocsp):
        return "‚ùå –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏"
    
    # –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï (–¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏):
    # 4. –¶–µ–ø–æ—á–∫–∞ –¥–æ–≤–µ—Ä–∏—è –±—ã–ª–∞ –ø–æ–ª–Ω–æ–π –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
    if not verify_chain_completeness_at_signing(cades_xl_signature.chain):
        print("‚ö†Ô∏è –¶–µ–ø–æ—á–∫–∞ –±—ã–ª–∞ –Ω–µ–ø–æ–ª–Ω–æ–π, –Ω–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ")
    
    return "‚úÖ –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –ø–æ–¥–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞"
```

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:

### –î–ª—è cryptcp.exe –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
```bash
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –∞—Ä—Ö–∏–≤–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π)
cryptcp -verify signature.sig document.pdf

# –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

# 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
certmgr -add -store root archive_root_cert.cer

# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
cryptcp -verify -nochaincheck signature.sig document.pdf

# 3. –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ API
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã LTV:
```python
class LongTermVerifier:
    def verify_archival_signature(self, signature, document):
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ CAdES-XL
        signer_cert = signature.get_signer_certificate()
        ocsp_response = signature.get_ocsp_response() 
        tsp_token = signature.get_timestamp_token()
        cert_chain = signature.get_certificate_chain()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ:
        # 1. –ü–æ–¥–ø–∏—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—É
        if not self.verify_signature_match(signature, document):
            return False
            
        # 2. TSP –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
        if not self.verify_historical_tsp(tsp_token):
            return False
            
        # 3. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –±—ã–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
        if not self.verify_historical_cert_status(ocsp_response):
            return False
            
        # –¶–µ–ø–æ—á–∫–∞ –¥–æ–≤–µ—Ä–∏—è –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        # –ú—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º —Ñ–∞–∫—Ç, —á—Ç–æ –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –æ–Ω–∞ –±—ã–ª–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞
        
        return True
```

## –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã (63-–§–ó —Å —É—á–µ—Ç–æ–º –∞—Ä—Ö–∏–≤–æ–≤):

### –°—Ç–∞—Ç—å—è 11.1:
"–ö–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Å—å –ø—Ä–∏–∑–Ω–∞–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —É—Å–ª–æ–≤–∏–π:
- –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∫–ª—é—á–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –¥–µ–π—Å—Ç–≤–æ–≤–∞–ª"

**–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: "–Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è"**

## –í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

### –í—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤—ã –≤ —Å–≤–æ–∏—Ö —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è—Ö:

1. **‚úÖ –ö–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ù–ï –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ**
2. **‚úÖ OCSP-–æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤**
3. **‚úÖ CAdES-XL –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è**
4. **‚úÖ –ó–∞–∫—Ä—ã—Ç—ã–µ –£–¶ –Ω–µ –¥–æ–ª–∂–Ω—ã –≤–ª–∏—è—Ç—å –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é**

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è:

```mermaid
graph TB
    A[–°—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏] --> B[–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤]
    A --> C[–§–æ–∫—É—Å –Ω–∞ TSP-–≤–∞–ª–∏–¥–∞—Ü–∏–∏]
    A --> D[–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –£–¶]
    
    E[–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è] --> F[–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ LTV-—Å–∏—Å—Ç–µ–º—ã]
    E --> G[–ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏]
    E --> H[–ê—Ä—Ö–∏–≤–∞—Ü–∏—è –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤]
```

### –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å:

**–ù–µ—Ç, –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –£–¶ –ù–ï –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è CAdES-XL.** 

–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è –≤:
1. **–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ TSP-–º–µ—Ç–∫–∏** –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è
2. **–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∞–Ω—Ç–∞** –Ω–∞ –º–æ–º–µ–Ω—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è (–ø–æ OCSP)
3. **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞**

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤—Ä–æ–¥–µ cryptcp.exe –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –Ω–∞–ª–∏—á–∏—è –∫–æ—Ä–Ω–µ–≤—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –Ω–æ —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∞ –Ω–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ CAdES-XL –∏–ª–∏ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞.

–ë–ª–∞–≥–æ–¥–∞—Ä—é –∑–∞ —ç—Ç–æ—Ç –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å! –û–Ω –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –≥–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π.
